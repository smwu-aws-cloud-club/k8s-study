# ì»¨í”¼ê·¸ë§µ ~ ì‹œí¬ë¦¿

> í•œì¤„í‰ : 
ì»¨í”¼ê·¸ë§µê³¼ ì‹œí¬ë¦¿ì„ ì‚¬ìš©í•˜ë©´ , ì• í”Œë¦¬ì¼€ì´ì…˜ ì½”ë“œ ë°°í¬ë¥¼ ìƒˆë¡œ í•  í•„ìš” ì—†ì´ ,
 pod ì¤‘ë‹¨ ì—†ì´ , ì–¸ì œë“ ì§€ ìˆ˜ì •ì‚¬í•­ì„ ì ìš©ì‹œí‚¬ ìˆ˜ ìˆë‹¤. ì™„ì „ good
> 

# Kubernetes

í•˜ìœ„ ë¬¸ì„œ ì •ë¦¬

https://kubernetes.io/ko/docs/concepts/configuration/configmap/

https://kubernetes.io/ko/docs/concepts/configuration/secret/

https://kubernetes.io/ko/docs/tasks/inject-data-application/distribute-credentials-secure/

ë°°ê²½ 

ì¿ ë²„ë„¤í‹°ìŠ¤ì—ì„œëŠ” ì„¤ì • ê°’ì„ í•˜ë“œì½”ë”©í•˜ì§€ ë§ê³  ì™¸ë¶€ì—ì„œ ì£¼ì…í•˜ëŠ” ê²ƒì„ ê¶Œì¥í•œë‹¤. 

- ì„¤ì •ë§Œ ë°”ê¾¸ê³  ì‹¶ì„ë•Œ , ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ë¥¼ êµì²´í•  í•„ìš”ì—†ê³ , ë¯¼ê°í•œ ì •ë³´ëŠ” ë”°ë¡œ ì•ˆì „í•˜ê²Œ ê´€ë¦¬í•  ìˆ˜ ìˆë‹¤.
- ì¼ë°˜ ì„¤ì •ê°’ì€ `ConfigMap`, ë¯¼ê°í•œ ê°’ì€ `Secret`ì´ë ‡ê²Œ ë‚˜ëˆ ì„œ ì‚¬ìš©

# Configmap

> í‚¤-ê°’ ìŒìœ¼ë¡œ ê¸°ë°€ì´ ì•„ë‹Œ ë°ì´í„°ë¥¼ ì €ì¥í•˜ëŠ”ë°  ì‚¬ìš©í•˜ëŠ” API ì˜¤ë¸Œì íŠ¸ 
íŒŒë“œëŠ” ë³¼ë¥¨ì—ì„œ í™˜ê²½ ë³€ìˆ˜, ì»¤ë§¨ë“œ-ë¼ì¸ ì¸ìˆ˜ ë˜ëŠ” êµ¬ì„±íŒŒì¼ë¡œ ì»¨í”¼ê·¸ë§µì„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
> 

ì¥ì  : ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ì—ì„œ í™˜ê²½ë³„ êµ¬ì„±ì„ ë¶„ë¦¬í•˜ì—¬, ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‰½ê²Œ ì´ì‹í•  ìˆ˜ ìˆë‹¤. 

ë‹¨ì  : ì»¨í”¼ê·¸ë§µì€ ë³´ì•ˆ/ ì•”í˜¸í™”ë¥¼ ì œê³µí•˜ì§€ ì•Šìœ¼ë¯€ë¡œ, ê¸°ë°€ë°ì´í„°ë¥¼ ì €ì¥í•˜ë ¤ëŠ” ê²½ìš° ì»¨í”¼ê·¸ ë§µ ëŒ€ì‹  ì‹œí¬ë¦¿(Secret)ì„ ì‚¬ìš©í•´ë¼!

## ì‚¬ìš© ë™ê¸°

ì• í”Œë¦¬ì¼€ì´ì…˜ ì½”ë“œëŠ” ê·¸ëŒ€ë¡œ ë‘ê³ , ì‹¤í–‰í™˜ê²½ì— ë”°ë¼ ì„¤ì •ë§Œ ë°”ê¿”ì„œ ìœ ì—°í•˜ê²Œ ë°°í¬í•˜ê¸° ìœ„í•¨

[ì˜ˆì‹œ]

1. ì½”ë“œì—ì„œëŠ” ë‹¨ìˆœíˆ System.getenv(â€DataBase_HOSTâ€) , process.env.DATABASE_HOST ë“±ìœ¼ë¡œ ì½ê³ ë§Œ ìˆìŒ. 
2. ë¡œì»¬ì—ì„œëŠ” localhost, í´ë¼ìš°ë“œì—ì„œëŠ” my-db-serviceë¡œ ì„¤ì •
3. ì½”ë“œëŠ” ê·¸ëŒ€ë¡œâ†’ í™˜ê²½ë§Œ ë°”ê¿”ë„ ì˜ ë™ì‘

- í•œê³„ : 1Mib ì œí•œ
    - ConfigMapì˜ ìµœëŒ€ ì €ì¥ìš©ëŸ‰ì€ 1MiBì´ë‹¤
    - why? : etcd(ì¿ ë²„ë„¤í‹°ìŠ¤ ë‚´ë¶€ ì €ì¥ì†Œ ì„±ëŠ¥ì„ ë³´í˜¸í•˜ê¸° ìœ„í•´ ì œí•œí•œë‹¤.
    - ë” ë§ì€ ì–‘ì„ ì €ì¥í•´ì•¼í•˜ëŠ” ê²½ìš° ë³¼ë¥¨ì„ ë§ˆìš´íŠ¸ í•˜ëŠ” ê²ƒì„ ê³ ë ¤í•˜ê¸°

<aside>
ğŸ’¡

12-Factor App ì›ì¹™
ì¤‘ í•˜ë‚˜ì¸ ~ 

[Store config in the environment](https://12factor.net/config)

â€œ**ì„¤ì • ì •ë³´ëŠ” í™˜ê²½ ë³€ìˆ˜ì— ì €ì¥í•œë‹¤.â€ ë¥¼ ë”°ë¥´ëŠ” ì¢‹ì€ ì˜ˆì‹œì´ë‹¤.** 

</aside>

## Configmap ì˜¤ë¸Œì íŠ¸

> ë‹¤ë¥¸ ì˜¤ë¸Œì íŠ¸ê°€ ì‚¬ìš©í•  êµ¬ì„±(í™˜ê²½ì„¤ì • íŒŒì¼)ì„ ì €ì¥í•  ìˆ˜ ìˆëŠ” API ì˜¤ë¸Œì íŠ¸ 
â€ì‹œìŠ¤í…œ ì „ì²´ê°€ ê³µìœ í•´ì„œ ì°¸ê³ í•˜ëŠ” í™˜ê²½ ì„¤ì • íŒŒì¼â€
> 
- `spec`ì´ ìˆëŠ” ëŒ€ë¶€ë¶„ì˜ ì¿ ë²„ë„¤í‹°ìŠ¤ ì˜¤ë¸Œì íŠ¸ì™€ ë‹¬ë¦¬, ì»¨í”¼ê·¸ë§µì—ëŠ” `data`  `binaryData` í•„ë“œê°€ ì¡´ì¬
- ìœ„ í•„ë“œëŠ” í‚¤-ê°’ ìŒì„ ê°’ìœ¼ë¡œ í—ˆìš©í•˜ë©°, optionalì„
- data : UTF -8 ë¬¸ìì—´ í¬í•¨
- binaryData : base64 ì¸ì½”ë”©ëœ ê°’(ì¸ì¦ì„œ, í‚¤ ë“±)

â‡’ ì»¨í”¼ê·¸ë§µì˜ ì´ë¦„ì€ ìœ íš¨í•œ DNS ì„œë¸Œë„ë©”ì¸ ì´ë¦„ì´ì–´ì•¼í•¨

- ìš©ì–´ì •ë¦¬
    
    spec í•„ë“œë€?
    
    - ë¦¬ì†ŒìŠ¤ì˜ í•µì‹¬ ë™ì‘ ì •ì˜ê°€ ë‹´ê¸°ëŠ” ê³³ ex) Pod.spec : ì–´ë–¤ ì»¨í…Œì´ë„ˆë¥¼ ë„ìš¸ì§€
    

## Configmapê³¼ íŒŒë“œ

ì»¨í”¼ê·¸ë§µì„ ì°¸ì¡°í•˜ëŠ” íŒŒë“œ `spec`ì„ ì‘ì„±í•˜ê³  ì»¨í”¼ê·¸ë§µ ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•´ë‹¹ íŒŒë“œì˜ ì»¨í…Œì´ë„ˆë¥¼ êµ¬ì„±í•  ìˆ˜ ìˆë‹¤. 

- íŒŒë“œì™€ ì»¨í”¼ê·¸ë§µì€ ë™ì¼í•œ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì— ìˆì–´ì•¼ í•œë‹¤.
- âš ï¸ **static íŒŒë“œ**ì˜ specì€ ì»¨í”¼ê·¸ë§µ ë˜ëŠ” ë‹¤ë¥¸ API ì˜¤ë¸Œì íŠ¸ë¥¼ ì°¸ì¡°í•  ìˆ˜ ì—†ë‹¤.

 

> static íŒŒë“œ :
> 
> 
> **kubeletì´ ì§ì ‘ ì‹¤í–‰í•˜ëŠ” Pod**
> 
> â†’**API ì„œë²„ì™€ëŠ” ìƒê´€ì—†ì´. ë…¸ë“œì˜ ë¡œì»¬ íŒŒì¼ ì‹œìŠ¤í…œì— ìˆëŠ” YAML íŒŒì¼ì„ ë³´ê³  ì‹¤í–‰**
> 
> ğŸ’¡ ì¼ë°˜ Pod: kubectl apply â†’ API ì„œë²„ â†’ ìŠ¤ì¼€ì¤„ë§
> ğŸ’¡ Static Pod: /etc/kubernetes/manifests/ í´ë”ì— YAML ë„£ìœ¼ë©´ kubeletì´ ì§ì ‘ ì‹¤í–‰
> 
> â‡’ ë•Œë¬¸ì— static íŒŒë“œì˜ ì„¤ì •ì„ ë³€ê²½í•˜ë ¤ë©´, 
> 
> - ConfigMap ëª» ì“°ë‹ˆê¹Œ, **YAMLì— ì§ì ‘ ê°’ì„ ì ì–´ì•¼ í•˜ê±°ë‚˜**
> - í˜¹ì€ **ì™¸ë¶€ í™˜ê²½ ë³€ìˆ˜ë‚˜ íŒŒì¼ë¡œ ì§ì ‘ ì£¼ì…**í•´ì•¼ í•œë‹¤. (Docker ë°©ì‹ì²˜ëŸ¼)

```yaml
apiVersion: v1
kind: ConfigMap
metadata:
	name: game-demo
data:
# ì†ì„±ê³¼ ë¹„ìŠ·í•œ í‚¤; ê° í‚¤ëŠ” ê°„ë‹¨í•œ ê°’ìœ¼ë¡œ ë§¤í•‘ë¨
	player_initial_lives: "3"
	ui_properties_file_name: "user-interface.properties"

# íŒŒì¼ê³¼ ë¹„ìŠ·í•œ í‚¤
	game.properties: |    
		enemy.types=aliens,monsters
		player.maximum-lives=5
	user-interface.properties: |    
		color.good=purple
		color.bad=yellow
		allow.textmode=true
```

**[**Configmapìœ¼ë¡œ **pod ì»¨í…Œì´ë„ˆë¥¼ ì–´ë–»ê²Œ êµ¬ì„±í•˜ëŠ”ê°€? 4ê°€ì§€ë°©]**

1. ì»¨í…Œì´ë„ˆ ì»¤ë§¨ë“œì™€ ì¸ìˆ˜ ë‚´ì—ì„œ ì‚¬ìš©í•˜ê¸° (command/args) : ì‹¤í–‰ ëª…ë ¹ì–´ ìì²´ì— configMap ì£¼
2. í™˜ê²½ ë³€ìˆ˜ë¡œ ì£¼ì…í•˜ê¸° (`env`) 
    - Pod Yaml íŒŒì¼ì— ì •ì˜ëœ ê°’ì„ ì£¼ì…í•´ì„œ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì‚¬ìš©í•˜ê²Œ í•˜ëŠ” ë°©ë²•
    - ì´ë•Œ, ì‹¤ì œ ì •ì˜ëŠ” configmapì— í•´ë‘ê³  yaml íŒŒì¼ì—ì„œëŠ” configmapì„ ì°¸ì¡°í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ì‚¬ìš©
3. ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì½ì„ ìˆ˜ ìˆëŠ” íŒŒì¼ í˜•íƒœë¡œ ì»¨í…Œì´ë„ˆ ë³¼ë¥¨ì— ë§ˆìš´íŠ¸
    - Yaml íŒŒì¼ì— ì •ì˜ëœ configmap ê³¼ , ê²½ë¡œë¥¼ í†µí•´  íŒŒì¼ í˜•íƒœë¡œ ë§ˆìš´íŠ¸
4. ì¿ ë²„ë„¤í‹°ìŠ¤ APIë¡œ ì§ì ‘ ì½ë„ë¡ ì‹¤í–‰í•  ì½”ë“œ ì‘ (ë™ì  ì ‘ê·¼)

â†’ ì†Œë¹„ë˜ëŠ” ë°ì´í„°ë¥¼ ëª¨ë¸ë§í•˜ëŠ” ë°©ì‹í•˜ëŠ” ë°©ì‹ì— ë”°ë¼ ë‹¤ë¥´ê²Œ ì“°ì„ :: ì´ê±°ëŠ” ì‹¤ì œë¡œ í™œìš©ë„ê°€ êµ‰ì¥íˆ ë†’ì„ ë“¯ í•˜ë¯€ë¡œ , ê° ë°©ì‹ ë³„ ì˜ˆì‹œë„ ì°¾ì•„ë³´ë©´ ì¢‹ì„ ë“¯í•¨. 

```yaml
apiVersion: v1
kind: Pod
metadata:
	name: mypod
spec:
	containers:
  -name: mypod
	image: redis
	volumeMounts:
    -name: foo
		mountPath: "/etc/foo"
		readOnly:true
	volumes:  # ì—¬ê¸°ì„œ ì‚¬ìš©í•˜ë ¤ëŠ” ì»¨í”¼ê·¸ë§µ ì°¸ì¡°
  -name: foo
		configmap:
			name: myconfigmap
		
```

- ë§Œì•½ íŒŒë“œì— ì—¬ëŸ¬ ì»¨í…Œì´ë„ˆê°€ ìˆëŠ” ê²½ìš° , ê° ì»¨í…Œì´ë„ˆëŠ” ìì²´ volumeMounts ë¸”ë¡ì´ í•„ìš”í•˜ë‹¤.
- ì»¨í”¼ê·¸ë§µì€ ê° ì»¨í”¼ê·¸ë§µ ë‹¹ í•˜ë‚˜ì˜ .spec.volumes ë§Œ í•„ìš”í•˜ë‹¤.

**[ë§ˆìš´íŠ¸ ëœ** Configmap **ìë™ ì—…ë°ì´íŠ¸ ]**

- í˜„ì¬ ë³¼ë¥¨ì— ë§ˆìš´íŠ¸ëœ ì»¨í”¼ê·¸ë§µì´ ì—…ë°ì´íŠ¸ ë  ì‹œ , í”„ë¡œì ì…˜ í‚¤ë„ ì—…ë°ì´íŠ¸ ë¨
- kubeletì—ì„œ ì£¼ê¸°ì ìœ¼ë¡œ ë§ˆìš´íŠ¸ ì»¨í”¼ê·¸ë§µì´ ìµœì‹ ìƒíƒœì¸ì§€ í™•ì¸í•œë‹¤ but, kubeletì€ ë¡œì»¬ ìºì‹œì—ì„œ ì»¨í”¼ê·¸ë§µ í˜„ì¬ ê°’ì„ ê°€ì ¸ì˜¨ë‹¤ëŠ” ì‚¬ì‹¤ì„ ì•Œ ê²ƒ ( - ì™„ì „í•œ ì‹¤ì‹œê°„ ë°˜ì˜ì€ ì•„ë‹˜)
    
    â†’ ë•Œë¬¸ì— ìƒˆ í‚¤ê°€ íŒŒë“œì— ì—…ë°ì´íŠ¸ ë ë•Œ ê¹Œì§€ ì´ ì§€ì—°ì‹œê°„  : kubelet ë™ê¸°í™” ê¸°ê°„ + ìºì‹œ ì „íŒŒ ì§€ì—°
    

### ë³€ê²½í•  ìˆ˜ ì—†ëŠ”(immutable) ì»¨í”¼ê·¸ë§µ

- *ë³€ê²½í•  ìˆ˜ ì—†ëŠ” ì‹œí¬ë¦¿ê³¼ ì»¨í”¼ê·¸ë§µ* ì€ ê°œë³„ ì‹œí¬ë¦¿ê³¼ ì»¨í”¼ê·¸ë§µì„ ë³€ê²½ í•  ìˆ˜ ì—†ëŠ” ê²ƒìœ¼ë¡œ ì„¤ì •í•˜ëŠ” ì˜µì…˜ `immutable: true` ì„ ì œê³µí•œë‹¤.
    - ì• í”Œë¦¬ì¼€ì´ì…˜ ì¤‘ë‹¨ì„ ì¼ìœ¼í‚¬ ìˆ˜ ìˆëŠ” ì›ì¹˜ì•ŠëŠ” ì—…ë°ì´íŠ¸ë¡œë¶€í„° ë³´í˜¸
    - immutableë¡œ í‘œì‹œëœ ì»¨í”¼ê·¸ë§µì— ëŒ€í•œ ê°ì‹œë¥¼ ì¤‘ë‹¨ â†’ kube-apiserver ë¶€í•˜ ê°ì†Œ â†’ í´ëŸ¬ìŠ¤í„°ì„±ëŠ¥í–¥ìƒ

```yaml
apiVersion: v1
kind: ConfigMap
metadata:
  ...
data:
  ...
immutable:true
```

# ì‹œí¬ë¦¿(Secret)

[ëª¨ë²”ì‚¬ë¡€ ì°¸ê³ í•˜ê¸°!!](https://kubernetes.io/ko/docs/concepts/security/secrets-good-practices/)

> ì•”í˜¸, í† í° ë˜ëŠ” í‚¤ì™€ ê°™ì€ ì†ŒëŸ‰ì˜ ì¤‘ìš”í•œ ë°ì´í„°ë¥¼ í¬í•¨í•˜ëŠ” ì˜¤ë¸Œì íŠ¸ 
â†’ ê¸°ë°€ ë°ì´í„°ë¥¼ ì• í”Œë¦¬ì¼€ì´ì…˜ì— ë„£ì„ í•„ìš”ê°€ ì—†ê²Œ í•œë‹¤.
> 
- íŒŒë“œì™€ ë…ë¦½ì ìœ¼ë¡œ ìƒì„±ë˜ê¸° ë•Œë¬¸ì—, íŒŒë“œì˜ ìƒì„±/í™•ì¸/ìˆ˜ì • ì›Œí¬í”Œë¡œìš° ë™ì•ˆ ì‹œí¬ë¦¿ ë…¸ì¶œì˜ ìœ„í—˜ì„ ê²½ê°ì‹œí‚¨ë‹¤.

<aside>
âš ï¸

ì¿ ë²„ë„¤í‹°ìŠ¤ ì‹œí¬ë¦¿

etcdì— ì•”í˜¸í™”ë˜ì§€ì•Šì€ ìƒíƒœë¡œ ì €ì¥ 

â†’ api access ê¶Œí•œì´ ìˆëŠ” or etcdì— ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” ëª¨ë“  ì‚¬ìš©ìê°€ ì‹œí¬ë¦¿ì„ ì¡°íšŒ/ìˆ˜ì • ê°€ëŠ¥

â†’ í•´ë‹¹ ë„¤ì„ ìŠ¤í˜ì´ìŠ¤ íŒŒë“œ ìƒì„± ê¶Œí•œì´ ìˆëŠ” ëˆ„êµ¬ë‚˜ í•´ë‹¹ ì ‘ê·¼ì„ ì‚¬ìš©í•˜ì—¬  ì‹œí¬ë¦¿ì„ ì½ì„ ìˆ˜ ìˆìŒ

ë”°ë¼ì„œ ì•ˆì „í•˜ê²Œ ì‚¬ìš©í•˜ë ¤ë©´?

1. ì‹œí¬ë¦¿ì— ëŒ€í•´ ì €ì¥ëœ ë°ì´í„° ì•”í˜¸í™”(Encryption at Rest) í™œì„±í™”
2. ì‹œí¬ë¦¿ì— ëŒ€í•œ ìµœì†Œí•œì˜ ì ‘ê·¼ ê¶Œí•œì„ ì§€ë‹ˆë„ë¡ RBAC ê·œì¹™ í™œì„±í™”
3. íŠ¹ì • ì»¨í…Œì´ë„ˆ ì—ì„œë§Œ ì‹œí¬ë¦¿ì— ì ‘ê·¼í•˜ë„ë¡ í•œë‹¤. 
4. ì™¸ë¶€ ì‹œí¬ë¦¿ ì €ì¥ì†Œ ì œê³µ ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ê³ ë ¤í•œë‹¤. 

 

</aside>

## ì‹œí¬ë¦¿ì˜ ì‚¬ìš©

íŒŒë“œê°€ ì‹œí¬ë¦¿ì„ ì‚¬ìš©í•˜ëŠ” ë°©ë²• 3ê°€ì§€

1. [í•˜ë‚˜ ì´ìƒì˜ ì»¨í…Œì´ë„ˆì— **ë§ˆìš´íŠ¸ëœ ë¶ˆë¥¨ ë‚´ì˜ íŒŒì¼**ë¡œì¨ ì‚¬ìš©](https://www.notion.so/1edbd7ce447180808fd6fdbb3dcfe347?pvs=21)
2. [ì»¨í…Œì´ë„ˆ **í™˜ê²½ ë³€ìˆ˜**ë¡œì¨ ì‚¬ìš©](https://www.notion.so/1edbd7ce447180808fd6fdbb3dcfe347?pvs=21)
3. íŒŒë“œì˜ ì´ë¯¸ì§€ë¥¼ ê°€ì ¸ì˜¬ ë•Œ **kubelet**ì— ì˜í•´ ì‚¬ìš©

**ì‹œí¬ë¦¿ì˜ ëŒ€ì²´í’ˆ**

- ì„œë¹„ìŠ¤ì–´ì¹´ìš´íŠ¸ ë° í† í°ì„ ì´ìš©í•˜ì—¬ í´ë¼ì´ì–¸íŠ¸ë¥¼ ì‹ë³„
- ì¨ë“œíŒŒí‹° ë„êµ¬ë¥¼ í´ëŸ¬ìŠ¤í„° ë‚´ë¶€ ë˜ëŠ” ì™¸ë¶€ì— ì‹¤í–‰
- X.509 ì¸ì¦ì„œë¥¼ ìœ„í•œ ì»¤ìŠ¤í…€ ì¸ì¦ì êµ¬í˜„ ë° CertificateSigningRequests ì´ìš©
- ì¥ì¹˜ í”ŒëŸ¬ê·¸ì¸ ì‚¬ìš© - ë…¸ë“œì˜ ì•”í˜¸í™” í•˜ë“œì›¨ì–´ë¥¼ íŠ¹ì • íŒŒë“œì— ë…¸ì¶œ

**ì‹œí¬ë¦¿ ì´ë¦„ ë° ë°ì´í„°ì— ëŒ€í•œ ì œì•½ ì‚¬í•­**

- secret objectì˜ ì´ë¦„ì€ **ìœ íš¨í•œ  DNS ì„œë¸Œë„ë©”ì¸ ì´ë¦„** ì´ì–´ì•¼í•œë‹¤.
- `data`ëŠ” base64 ì¸ì½”ë”©ëœ ê°’ì„ ë„£ì–´ì•¼ í•˜ê³ , `stringData`ëŠ” ì¼ë°˜ ë¬¸ìì—´ì„ ë°”ë¡œ ë„£ì„ ìˆ˜ ìˆë‹¤.
- `stringData`ëŠ” ì„ ì–¸ ì‹œ ìë™ìœ¼ë¡œ `data`ë¡œ ë³€í™˜ëœë‹¤.
- ë™ì¼í•œ í‚¤ê°€ ë‘˜ ë‹¤ì— ìˆì„ ê²½ìš°, `stringData`ê°’ì´ ìš°ì„ ëœë‹¤.

â‡’ ì‚¬ì‹¤ìƒ dataëŠ” base64 í¬ë§·ì´ë¼ ë¶ˆí¸í•˜ë‹ˆ stringDataë§Œ ì“°ë©´ í¸í•œê±° ì•„ë‹Œê°€?
 ê·¼ë°~ dataëŠ” ìë™í™” ìŠ¤í¬ë¦½íŠ¸ë‚˜ Helm , API í†µì‹ ë“±ì—ì„œ ê¸°ê³„ì ìœ¼ë¡œ ì“¸ ë•Œ ìœ ë¦¬í•˜ë‹¤ë„¤,,

**í¬ê¸° ì œí•œ**

> ê°œë³„ ì‹œí¬ë¦¿ í¬ê¸°ëŠ” 1Mib ì œí•œì´ ìˆìŒ
> 

**ì‹œí¬ë¦¿ ìˆ˜ì •í•˜ê¸°** 

- ì‹œí¬ë¦¿ì€ ë¶ˆë³€(immutable)ë§Œ ì•„ë‹ˆë©´ ìˆ˜ì •ë  ìˆ˜ ìˆë‹¤.
- ë°©ë²•
    - [kubectl ì‚¬ìš©í•˜ê¸°](https://kubernetes.io/ko/docs/tasks/configmap-secret/managing-secret-using-kubectl/#edit-secret)
    - [ì„¤ì • íŒŒì¼ ì‚¬ìš©í•˜ê¸°](https://kubernetes.io/ko/docs/tasks/configmap-secret/managing-secret-using-config-file/#edit-secret)

## ì‹œí¬ë¦¿ ë‹¤ë£¨ê¸°

**ì‹œí¬ë¦¿ ìƒì„±í•˜ëŠ” 3ê°€ì§€ ë°©ì‹**

- [kubectl ì‚¬ìš©](https://kubernetes.io/ko/docs/tasks/configmap-secret/managing-secret-using-kubectl/)
- [í™˜ê²½ ì„¤ì • íŒŒì¼ ì‚¬ìš©](https://kubernetes.io/ko/docs/tasks/configmap-secret/managing-secret-using-config-file/)
- [kustomize ë„êµ¬ ì‚¬ìš©](https://kubernetes.io/ko/docs/tasks/configmap-secret/managing-secret-using-kustomize/)

**ì‹œí¬ë¦¿ ì‚¬ìš©**

- !ì‹œí¬ë¦¿ì€ ì˜ì¡´ê´€ê³„ì¸ íŒŒë“œë³´ë‹¤ ë¨¼ì € ìƒì„±ë˜ì–´ì•¼í•œë‹¤!
    - ì°¸ì¡°ê°€ ì‹¤ì œë¡œ ì‹œí¬ë¦¿ ì˜¤ë¸Œì íŠ¸ë¥¼ ê°€ë¦¬í‚¤ëŠ”ì§€ í™•ì¸í•˜ê¸° ìœ„í•´ ë³¼ë¥¨ ì†ŒìŠ¤ì˜ ìœ íš¨ì„± ê²€ì‚¬ê°€ ì„ í–‰ë¨
    - ê°€ì ¸ì˜¬ ìˆ˜ ì—†ëŠ” ê²½ìš° , kubeletì€ í•´ë‹¹ íŒŒë“œ ì‹¤í–‰ì„ ì£¼ê¸°ì ìœ¼ë¡œ ì¬ì‹œë„ í•œë‹¤. & ì´ë²¤íŠ¸ ë³´ê³ 

**ì„ íƒì  ì‹œí¬ë¦¿**

- í™˜ê²½ ë³€ìˆ˜ë¡œ ì •ì˜í•˜ëŠ” ê²½ìš°, **optional** ì„¤ì • ê°€ëŠ¥ (default : í•„ìˆ˜)
- ëª¨ë“  í•„ìˆ˜ ì‹œí¬ë¦¿ì´ â€˜ì‚¬ìš©ê°€ëŠ¥â€™í•´ì§€ê¸° ì „ê¹Œì§€ëŠ” íŒŒë“œ ì»¨í…Œì´ë„ˆëŠ” ì‹œì‘ë  ìˆ˜ ì—†ë‹¤ ( ì‹œì‘ê³¼ì •ì—ì„œ ì‹¤íŒ¨í•  ê²ƒ)

**íŒŒë“œì—ì„œ ì‹œí¬ë¦¿ì„ íŒŒì¼ì²˜ëŸ¼ ì‚¬ìš©í•˜ê¸°** 

```yaml
apiVersion: v1
kind: Pod
metadata:
	name: mypod
spec:
	containers:
  -name: mypod
	image: redis
	volumeMounts:
    -name: foo # volumes[].nameê³¼ volumeMounts[].nameì€ ë°˜ë“œì‹œ ì¼ì¹˜í•´ì•¼í•¨
		mountPath: "/etc/foo" # ì‹œí¬ë¦¿ data map ì˜ ê° í‚¤ëŠ” í•´ë‹¹ ê²½ë¡œ í•˜ìœ„ì˜ íŒŒì¼ëª…ì´ ëœë‹¤. 
		readOnly:true
	volumes:
  -name: foo # volumes[].nameê³¼ volumeMounts[].nameì€ ë°˜ë“œì‹œ ì¼ì¹˜í•´ì•¼í•¨
	secret:
		secretName: mysecret
		optional:false # ê¸°ë³¸ê°’ì„; "mysecret" ì€ ë°˜ë“œì‹œ ì¡´ì¬í•´ì•¼ í•¨
```

1. ì‹œí¬ë¦¿ ìƒì„±
2. .spec.volumes[]. í•˜ìœ„ì— ë³¼ë¥¨ ì¶”ê°€( ì´ë•Œ `.spec.volumes[].secret.secretName` ì‹œí¬ë¦¿ ì˜¤ë¸Œì íŠ¸ ëª…ê³¼ ì¼ì¹˜í•´ì•¼í•¨)
3. ì‹œí¬ë¦¿ì´ í•„ìš”í•œ ê° ì»¨í…Œì´ë„ˆì— `.spec.containers[].volumeMounts[]` ì¶”ê°€

**íŠ¹ì • ê²½ë¡œì— ëŒ€í•œ ì‹œí¬ë¦¿ í‚¤ íˆ¬ì˜í•˜ê¸°** 

- `.spec.volumes[].secret.items` : ì‹œí¬ë¦¿ í‚¤ê°€ íˆ¬ì˜ë˜ëŠ” ë³¼ë¥¨ ë‚´ ëŒ€ìƒ ê²½ë¡œ ë³€ê²½ ê°€ëŠ¥
    
    ```yaml
    apiVersion: v1
    kind: Pod
    metadata:
    	name: mypod
    spec:
    	containers:
    	  -name: mypod
    		image: redis
    		volumeMounts:
    		  -name: foo
    			mountPath: "/etc/foo"
    			readOnly:true
    	volumes:
    	  -name: foo
    			secret:
    				secretName: mysecret
    				items:
    		      -key: username
    					path: my-group/my-username
    ```
    
- ì‹œí¬ë¦¿ ì˜¤ë¸Œì íŠ¸ì˜ password keyëŠ” íˆ¬ì˜ë˜ì§€ X
- ìœ„ì™€ ê°™ì´ ëª…ì‹œì ìœ¼ë¡œ í‚¤ë¥¼ ë‚˜ì—´í–ˆë‹¤ë©´, ë‚˜ì—´ëœ ëª¨ë“ í‚¤ê°€ ì‹œí¬ë¦¿ì— ì¡´ì¬í•´ì•¼ë§Œ í•¨ â†’ ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ ë³¼ë¥¨ ìƒì„±ë˜ì§€ X

ì‹œí¬ë¦¿ íŒŒì¼ í¼ë¯¸ì…˜

> ë‹¨ì¼ ì‹œí¬ë¦¿ì— ëŒ€í•œ POSIX íŒŒì¼ì ‘ê·¼ í¼ë¯¸ì…˜ ë¹„íŠ¸ ì„¤ì • ê°€ëŠ¥ ( default : 0644) 
ex) ì „ì²´ ì‹œí¬ë¦¿ ë³¼ë¥¨ì— ëŒ€í•œ ê¸°ë³¸ ëª¨ë“œ ì„¤ì • í›„ , í•„ìš” ì‹œ ê° í‚¤ë³„ë¡œ ì˜¤ë²„ë¼ì´ë“œ ê°€ëŠ¥
> 

```yaml
apiVersion: v1
kind: Pod
metadata:
	name: mypod
spec:
	containers:
	  -name: mypod
		image: redis
		volumeMounts:
	    -name: foo
			mountPath: "/etc/foo"
	volumes:
	  -name: foo
		secret:
			secretName: mysecret
			defaultMode: 0400
```

**ë§ˆìš´íŠ¸ ëœ ì‹œí¬ë¦¿ì˜ ìë™ ì—…ë°ì´íŠ¸** 

> ë³¼ë¥¨ì´ ì‹œí¬ë¦¿ ë°ì´í„°ë¥¼ í¬í•¨í•˜ê³  ìˆëŠ” ìƒíƒœì—ì„œ , ì‹œí¬ë¦¿ì´ ì—…ë°ì´íŠ¸ ë˜ë©´, ì¿ ë²„ë„¤í‹°ìŠ¤ê°€ ì´ë¥¼ ì¶”ì í•˜ê³  eventually-consistent ì ‘ê·¼ ë°©ì‹ì„ ì‚¬ìš©í•˜ì—¬ ë³¼ë¥¨ ë°ì´í„°ë¥¼ ì—…ë°ì´íŠ¸ í•œë‹¤.
> 
- update ë°©ì‹ 2ê°€ì§€ : TTL ìºì‹œ ê¸°ë°˜ì˜ API watch ë©”ì»¤ë‹ˆì¦˜ìœ¼ë¡œ ì „íŒŒ or  kubelet ë™ê¸°í™” ì‹œ api ì„œë²„ì˜ í´ë§

**ì‹œí¬ë¦¿ì„ í™˜ê²½ ë³€ìˆ˜ í˜•íƒœë¡œ ì‚¬ìš©í•˜ê¸°**

1. ì‹œí¬ë¦¿ ìƒì„± (ì—¬ëŸ¬ íŒŒë“œê°€ ë™ì¼ ì‹œí¬ë¦¿ ì°¸ì¡° ê°€ëŠ¥)
2. `env[].valueFrom.secretKeyRef` : ì‹œí¬ë¦¿ì˜ name ê³¼ key ì •ì˜
3. ì¼ì¹˜í•˜ëŠ” í™˜ê²½ ë³€ìˆ˜ì—ì„œ ê°’ì„ ì°¾ë„ë¡ í”„ë¡œê·¸ë¨ì„ ìˆ˜ì •

```yaml
apiVersion: v1
kind: Pod
metadata:
name: secret-env-pod
spec:
	containers:
	  -name: mycontainer
		image: redis
		**env:**
		   -name: SECRET_USERNAME
				valueFrom:
					secretKeyRef:
						name: mysecret
						key: username
						optional:false # ê¸°ë³¸ê°’ê³¼ ë™ì¼í•˜ë‹¤
						# "mysecret"ì´ ì¡´ì¬í•˜ê³  "username"ë¼ëŠ” í‚¤ë¥¼ í¬í•¨í•´ì•¼ í•œë‹¤
		   -name: SECRET_PASSWORD
				valueFrom:
					**secretKeyRef:**
						name: mysecret
						key: password
						optional:false # ê¸°ë³¸ê°’ê³¼ ë™ì¼í•˜ë‹¤
						# "mysecret"ì´ ì¡´ì¬í•˜ê³  "password"ë¼ëŠ” í‚¤ë¥¼ í¬í•¨í•´ì•¼ í•œë‹¤
restartPolicy: Never
```

**ì˜¬ë°”ë¥´ì§€ ì•Šì€ í™˜ê²½ ë³€ìˆ˜** 

- í‚¤ì˜ ì´ë¦„ì´ ë¶€ì ì ˆí•œ í™˜ê²½ ë³€ìˆ˜ ì´ë¦„ì„ ê°–ê³  ìˆë‹¤ë©´ , íŒŒë“œê°€ ì‹¤í–‰ë˜ì§€ì•Šê³ , ì—ëŸ¬ê°€ ë°œìƒí•œë‹¤
    
    â†’ íŒŒë“œ ì‹œì‘ ì‹¤íŒ¨ ì •ë³´ì— ì¶”ê°€ëœë‹¤.
    
    ```yaml
    kubectl get events
    ```
    

**í™˜ê²½ ë³€ìˆ˜ë¡œë¶€í„° ì‹œí¬ë¦¿ ê°’ ì‚¬ìš©í•˜ê¸°** 

ì‹œí¬ë¦¿ì„ í™˜ê²½ ë³€ìˆ˜ë¡œ ì‚¬ìš©í•˜ëŠ” ì»¨í…Œì´ë„ˆ ë‚´ë¶€ì—ì„œ , ì‹œí¬ë¦¿ í‚¤ëŠ” í™˜ê²½ ë³€ìˆ˜ í˜•íƒœë¡œ ë³´ì¸ë‹¤

```yaml
echo "$SECRET_USERNAME"
```

ì¶œë ¥ ê²°ê³¼ : admin 

> âš ï¸ 
ê·¸ëŸ¬ë‚˜ Secret ì„  í™˜ê²½ ë³€ìˆ˜ í˜•íƒœë¡œ íŒŒë“œì— ì£¼ì…í•˜ë©´, 
ì‹œí¬ë¦¿ì´ ë‚˜ì¤‘ì— ë³€ê²½ë˜ë”ë¼ë„, ì»¨í…Œì´ë„ˆ ì•ˆì˜ í™˜ê²½ ë³€ìˆ˜ ê°’ì€ ë°”ë€Œì§€ ì•ŠëŠ”ë‹¤. 
í™˜ê²½ ë³€ìˆ˜ëŠ” íŒŒë“œ/ì»¨í…Œì´ë„ˆ ì‹œì‘ ì‹œì—ë§Œ ì´ˆê¸°í™” ë˜ê¸° ë•Œë¬¸ì—, ë°˜ì˜í•˜ë ¤ë©´ , ì»¨í…Œì´ë„ˆ ì¬ì‹œì‘ì´ í•„ìš”í•˜ë‹¤
> 

**ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ pull ì‹œí¬ë¦¿** 

- private registryì—ì„œ ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ë¥¼ ê°€ì ¸ì˜¤ê³  ì‹¶ë‹¤ë©´, ê° ë…¸ë“œ kubeletì´ í•´ë‹¹ ì €ì¥ì†Œì— ì¸ì¦ì„ ìˆ˜í–‰í•˜ëŠ” ë°©ë²•ì„ ë§ˆë ¨í•´ì•¼ í•œë‹¤. â†’ image pull Secret êµ¬ì„± (íŒŒë“œ level ì„¤ì •)
- `imagePullSecrets`Â  í•„ë“œ :
    - íŒŒë“œê°€ ì†í•œ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì— ìˆëŠ” ì‹œí¬ë¦¿ë“¤ì— ëŒ€í•œ ì°¸ì¡° ëª©ë¡
    - ì´ë¯¸ì§€ ì €ì¥ì†Œ ì ‘ê·¼ credentialì„ kubeletì— ì „ë‹¬ â†’ ì´ì •ë³´ë¥¼ ì´ìš©í•˜ì—¬, kubeletì´ íŒŒë“œ ëŒ€ì‹  private imageë“¤ì„ ê°€ì ¸ì˜´

| í•­ëª© | ì„¤ëª… |
| --- | --- |
| ğŸ” `imagePullSecrets` | í”„ë¼ì´ë¹— ë ˆì§€ìŠ¤íŠ¸ë¦¬ ì¸ì¦ ì •ë³´ |
| ğŸ§¾ `ServiceAccount` | íŒŒë“œê°€ ì‹¤í–‰ë  ë•Œ ì‚¬ìš©í•˜ëŠ” ì‹ ë¶„ |
| ğŸª„ ì—°ê²° ë°©ì‹ | ServiceAccountì— `imagePullSecrets`ë¥¼ ì§€ì •í•´ë‘ë©´, ê·¸ê±¸ ì‚¬ìš©í•˜ëŠ” íŒŒë“œë“¤ì€ ìë™ìœ¼ë¡œ ì¸ì¦ ì •ë³´ ì ìš©ë¨ |

**ìŠ¤íƒœí‹± íŒŒë“œì—ì„œì˜ ì‹œí¬ë¦¿ ì‚¬ìš©** 

> ìŠ¤íƒœí‹±(static) íŒŒë“œì—ì„œëŠ” ì»¨í”¼ê·¸ë§µì´ë‚˜ ì‹œí¬ë¦¿ì„ ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤.
> 

## ì‚¬ìš©ì‚¬ë¡€(ì‹œí¬ë¦¿ì„ ì»¨í…Œì´ë„ˆì— ì£¼ì…í•˜ëŠ” 5ê°€ì§€ ë°©

1. ë²•ì»¨í…Œì´ë„ˆ í™˜ê²½ ë³€ìˆ˜ë¡œ ì‚¬ìš©í•˜ê¸°(env, envFrom)
    
    ```yaml
    apiVersion: v1
    kind: Secret
    metadata:
    	name: mysecret
    type: Opaque
    data:
    	USER_NAME: YWRtaW4=
    	PASSWORD: MWYyZDFlMmU2N2Rm
    ```
    
    ```yaml
    apiVersion: v1
    kind: Pod
    metadata:
    	name: secret-test-pod
    spec:
    	containers:
        -name: test-container
    		image: registry.k8s.io/busybox
    		command: [ "/bin/sh", "-c", "env" ]
    		envFrom:
          -secretRef:
    				name: mysecret
    restartPolicy: Never
    ```
    
2. SSH í‚¤ë¥¼ ì‚¬ìš©í•˜ëŠ” íŒŒë“œ (volumeMount)
    - ìƒí™© : ì¿ ë²„ë„¤í‹°ìŠ¤ íŒŒë“œê°€ ì™¸ë¶€ ì„œë²„(git ì„œë²„, ì›ê²© ì„œë²„) ì— SSH ë¡œ ì ‘ì†í•´ì•¼í• ë•Œ SSH í‚¤ë¥¼ ì•ˆì „í•˜ê²Œ ê´€ë¦¬í•˜ê³  ì£¼ì…í•  ë°©ë²•ì´ í•„ìš”!
    - í‚¤ê°€ íŒŒì¼ ì´ë¦„ , ê°’ì´ íŒŒì¼ ë‚´ìš©
    - í™˜ê²½ë³€ìˆ˜ë³´ë‹¤ëŠ” íŒŒì¼ í˜•íƒœë¡œ ë§ˆìš´íŠ¸í•´ì„œ ì‚¬ìš©í•˜ëŠ” ê²Œ ì¼ë°˜ì 
    
    ```yaml
    apiVersion: v1
    kind: Pod
    metadata:
    	name: secret-test-pod
    	labels:
    		name: secret-test
    spec:
    	volumes:
    	-name: secret-volume
    	secret:
    		secretName: ssh-key-secret
    	containers:
      -name: ssh-test-container
    	image: mySshImage
    	volumeMounts:
        -name: secret-volume
    		readOnly:true
    		mountPath: "/etc/secret-volume"
    ```
    
3. [ìš´ì˜/ í…ŒìŠ¤íŠ¸ ìê²© ì¦ëª…ì„ ì‚¬ìš©í•˜ëŠ” íŒŒë“œ](https://www.notion.so/kubernetes-1cbbd7ce447180ebb790d16db41d042a?pvs=21)
    - ìš´ì˜/í…ŒìŠ¤íŠ¸ í™˜ê²½ì—ì„œ ì„œë¡œ ë‹¤ë¥¸ ìê²© ì¦ëª…ì„ íŒŒë“œì— ì£¼ì…í•˜ëŠ” ëª©ì 
    - íŒŒë“œ êµ¬ì„±ì€ ê°™ê³ , ì‹œí¬ë¦¿ë§Œ ë°”ê¿”ì„œ í™˜ê²½ êµ¬ë¶„ ê°€ëŠ¥(prod-secret , dev-secret)
    - volueMountê°€ í™˜ê²½ ë³€ìˆ˜ë³´ë‹¤ ìƒëŒ€ì  ì•ˆì „
4. ì‹œí¬ë¦¿ ë³¼ë¥¨ì˜ ë„íŠ¸ íŒŒì¼(dotfile)
    
    ```yaml
    apiVersion: v1
    kind: Secret
    metadata:
    name: dotfile-secret
    data:
    .secret-file: dmFsdWUtMg0KDQo=
    ---apiVersion: v1
    kind: Pod
    metadata:
    name: secret-dotfiles-pod
    spec:
    volumes:
      -name: secret-volume
    secret:
    secretName: dotfile-secret
    containers:
      -name: dotfile-test-container
    image: registry.k8s.io/busybox
    command:
        - ls
        - "-l"
        - "/etc/secret-volume"
    volumeMounts:
        -name: secret-volume
    readOnly:truemountPath: "/etc/secret-volume"
    ```
    
    - ì ìœ¼ë¡œ ì‹œì‘í•˜ëŠ” í‚¤ë¥¼ ì •ì˜ í•˜ì—¬ ë°ì´í„°ë¥¼ â€œìˆ¨ê¹€â€ í•  ìˆ˜ ìˆë‹¤.
    - **ìœ ì¶œ ê°€ëŠ¥ì„±ì€ ë‚®ì§€ë§Œ, `ls -la`Â ë¥¼ ì‚¬ìš©í•´ì•¼ ì´ íŒŒì¼ë“¤ì„ ë³¼ ìˆ˜ ìˆë‹¤.**
    - íŒŒì¼ëª…ì´ .ìœ¼ë¡œ ì‹œì‘í•˜ëŠ” dotfile í˜•íƒœ
5. íŒŒë“œì˜ í•œ ì»¨í…Œì´ë„ˆì— í‘œì‹œë˜ëŠ” ì‹œí¬ë¦¿
    - íŒŒë“œ ë‚´ íŠ¹ì • ì»¨í…Œì´ë„ˆì—ë§Œ ì‹œí¬ë¦¿ ì£¼ì…(ë‹¤ë¥¸ ì»¨í…Œì´ë„ˆì—ëŠ” ì•ˆë³´ì´ê²Œ
    - ì»¨í…Œì´ë„ˆ ë³„ env ë˜ëŠ” volumeMountë¥¼ ë¶„ë¦¬í•´ì„œ êµ¬ì„±
    - ë©€í‹° ì»¨í…Œì´ë„ˆ íŒŒë“œì—ì„œ ì—­í•  ë³„ ë³´ì•ˆê²½ê³„ë¥¼ ë§Œë“¤ê¸° ì¢‹ìŒ
    - ! íŠ¹íˆ ì‚¬ì´ë“œì¹´ì™€ ë©”ì¸ ì»¨í…Œì´ë„ˆ ë¶„ë¦¬ ! ì— ì¢‹ìŒ

## ì‹œí¬ë¦¿ íƒ€ì…

- [ë¶ˆíˆ¬ëª…(Opaque) ì‹œí¬ë¦¿](https://kubernetes.io/ko/docs/concepts/configuration/secret/#%EB%B6%88%ED%88%AC%EB%AA%85-opaque-%EC%8B%9C%ED%81%AC%EB%A6%BF)
    - ì‹œí¬ë¦¿ êµ¬ì„± íŒŒì¼ì—ì„œ íƒ€ì…ì„ ì§€ì •í•˜ì§€ ì•Šì•˜ì„ ê²½ìš° default íƒ€ì…
    - generic í•˜ìœ„ ì»¤ë§¨ë“œë¥¼ ì´ìš©í•´ì„œ Opaque ì‹œí¬ë¦¿ íƒ€ì…ì„ í‘œí˜„
- [ì„œë¹„ìŠ¤ ì–´ì¹´ìš´íŠ¸ í† í° ì‹œí¬ë¦¿](https://kubernetes.io/ko/docs/concepts/configuration/secret/#%EC%84%9C%EB%B9%84%EC%8A%A4-%EC%96%B4%EC%B9%B4%EC%9A%B4%ED%8A%B8-%ED%86%A0%ED%81%B0-%EC%8B%9C%ED%81%AC%EB%A6%BF)
    - ì„œë¹„ìŠ¤ ì–´ì¹´ìš´íŠ¸ë¥¼ í™•ì¸í•˜ëŠ” í† í° ìê²© ì¦ëª…ì„ ì €ì¥í•˜ê¸° ìœ„í•´ì„œ ì‚¬ìš©
    - ex) íŒŒë“œ ë‚´ë¶€ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì¿ ë²„ë„¤í‹°ìŠ¤ api ë¥¼ ì‚¬ìš©í•˜ë„ë¡ í• ë•Œ ì‚¬ìš©
    - [TokenRequest](https://kubernetes.io/docs/reference/kubernetes-api/authentication-resources/token-request-v1/) APIë¡œ ì–»ëŠ” í† í°ì„ ê¶Œì¥í•¨- ìˆ˜ëª…ì´ ì œí•œë˜ì–´ ì•ˆì „
    - 
- [ë„ì»¤ ì»¨í”¼ê·¸ ì‹œí¬ë¦¿](https://kubernetes.io/ko/docs/concepts/configuration/secret/#%EB%8F%84%EC%BB%A4-%EC%BB%A8%ED%94%BC%EA%B7%B8-%EC%8B%9C%ED%81%AC%EB%A6%BF)
    - í•˜ìœ„ ë‘ê°œ ì¤‘ í•˜ë‚˜ë¥¼ ì‚¬ìš© ê°€ëŠ¥
    - `kubernetes.io/dockercfg`
    - `kubernetes.io/dockerconfigjson`
- [ê¸°ë³¸ ì¸ì¦(Basic authentication) ì‹œí¬ë¦¿](https://kubernetes.io/ko/docs/concepts/configuration/secret/#%EA%B8%B0%EB%B3%B8-%EC%9D%B8%EC%A6%9D-basic-authentication-%EC%8B%9C%ED%81%AC%EB%A6%BF)
    - `username:password` ë¬¸ìì—´ì„ Base64ë¡œ ì¸ì½”ë”©í•œ í›„ HTTP í—¤ë”ì— ë‹´ì•„ ë³´ë‚´ëŠ” ì¸ì¦ ë°©ì‹
- [SSH ì¸ì¦ ì‹œí¬ë¦¿](https://kubernetes.io/ko/docs/concepts/configuration/secret/#ssh-%EC%9D%B8%EC%A6%9D-%EC%8B%9C%ED%81%AC%EB%A6%BF)
- [TLS ì‹œí¬ë¦¿](https://kubernetes.io/ko/docs/concepts/configuration/secret/#tls-%EC%8B%9C%ED%81%AC%EB%A6%BF)
- [ë¶€íŠ¸ìŠ¤íŠ¸ë© í† í° ì‹œí¬ë¦¿](https://kubernetes.io/ko/docs/concepts/configuration/secret/#%EB%B6%80%ED%8A%B8%EC%8A%A4%ED%8A%B8%EB%9E%A9-%ED%86%A0%ED%81%B0-%EC%8B%9C%ED%81%AC%EB%A6%BF)

# ë¶ˆë³€(Immutable) ì‹œí¬ë¦¿

```yaml
apiVersion: v1
kind: Secret
metadata:
  ...
data:
  ...
immutable:true
```

# ì‹œí¬ë¦¿ì„ ìœ„í•œ ì •ë³´ ë³´ì•ˆ

| í•­ëª© | ë³´ì•ˆ ê³ ë ¤ì‚¬í•­ |
| --- | --- |
| ì €ì¥ ë°©ì‹ | etcdì— base64ë¡œ ì €ì¥ë¨ (ê¸°ë³¸ ì•”í˜¸í™” X) |
| ì ‘ê·¼ ì œì–´ | RBACìœ¼ë¡œ ê¶Œí•œ ìµœì†Œí™” í•„ìˆ˜ |
| í™˜ê²½ ë³€ìˆ˜ ì‚¬ìš© | `ps` ëª…ë ¹ì–´ë¡œ ë…¸ì¶œ ìœ„í—˜ ìˆìŒ |
| ë³¼ë¥¨ ì‚¬ìš© | ë…¸ë“œ ì ‘ê·¼ ì‹œ íŒŒì¼ ì½ê¸° ê°€ëŠ¥ |
| ì„œë¹„ìŠ¤ ê³„ì • í† í° | ë¶ˆí•„ìš”í•œ ìë™ ë§ˆìš´íŠ¸ ë°©ì§€ í•„ìš” |
| ê°ì‚¬ ë° ëª¨ë‹ˆí„°ë§ | audit logë¡œ ì´ìƒ ì ‘ê·¼ ê°ì‹œ ì¶”ì²œ |